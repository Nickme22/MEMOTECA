<br>
<meta charset="UTF-8">

<title> APRENDIZADO </title>

<br> Apresentar nomes é o que estou tentando!! </br>


<link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet">
<link rel="stylesheet" href="style.css">

</head>

<b>

    <br><br>
    <prompt>VAMOS SALVAR DADOS</prompt>
    <br>
    <p></p>Digite seu nome: <input class="inputname " /><br>
    <p></p>Digite seu email: <input class="inputemail" type="text" onblur="validacaoEmail(this.value)" maxlength="60"
        size='65' /> <br>
    <span id="emailError" style="color: red;"></span>
    <p></p>Digite seu Telefone: <input class="inputtelefone " type="number" /><br>
    <p></p>Digite seu Usuário: <input class="inputuser " /><br>
    <p></p>Digite seu 1º Numero da sorte: <input class="inputlucknumber1 " type="number" /><br>
    <p></p>Digite seu 2º Numero da sorte: <input class="inputlucknumber2 " type="number" /><br>
    <p></p>Digite seu 3º Numero da sorte: <input class="inputlucknumber3 " type="number" /><br><br> <a href=".\projects.html"> <button salvar
        onclick=salvedados()>Salvar Dados</button>
    </a>
    <p></p>Buscar dados para verificação <input class="idInput" /><br></br> <button salve onclick=verificar()> Verifique
    </button>

    <header>

    </header>

    <section>

    </section>


    </body>
    <script>


        //FAZER MASCARA E VERIFICAÇÃO DO TELEFONE


        
        // mensagem de dados salvos

        //COLOCAR LAYOUT BONITO


        // outra forma de testar o email 



        function validacaoEmail(email) {
            // Expressão regular para verificar o formato do email
            var re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (re.test(email) &&
                (!email.endsWith("."))
            ) {
                document.getElementById("emailError").textContent = ""; // Limpa a mensagem de erro
            } else {
                document.getElementById("emailError").textContent = "Por favor, insira um email válido.";
            }
        }

        //



        // função guardar dados json

        function salvedados() {
            var nome = document.querySelector(".inputname");
            var email = document.querySelector(".inputemail");
            var telefone = document.querySelector(".inputtelefone");
            var usuario = document.querySelector(".inputuser");
            var luck1 = document.querySelector(".inputlucknumber1");
            var luck2 = document.querySelector(".inputlucknumber2");
            var luck3 = document.querySelector(".inputlucknumber3");
            var indice = Number.parseInt(divBase[divBase.length - 1].id) + 1;
            console.log(nome.value);
            console.log(email.value);
            console.log(telefone.value);
            console.log(usuario.value);
            console.log(luck1.value);
            console.log(luck2.value);
            console.log(luck3.value);
            console.log(indice);
            //FAZER A EXPORTAÇÃO DOS DADOS E SALVAMENTO NO JSON
            var dadosJson = {
                "id": indice,
                "usuario": usuario.value,
                "nome": nome.value,
                "email": email.value,
                "telefone": telefone.value,
                "ativo": true,
                "lucknumbers": [luck1.value, luck2.value, luck3.value]
                }

                divBase.push(dadosJson);
                console.log(divBase)
    

        // limpar campos para nova inserção depois da função

        document.querySelector(".inputname").value = "";
        document.querySelector(".inputemail").value = "";
        document.querySelector(".inputtelefone").value = "";
        document.querySelector(".inputuser").value = "";
        document.querySelector(".inputlucknumber1").value = "";
        document.querySelector(".inputlucknumber2").value = "";
        document.querySelector(".inputlucknumber3").value = "";

        }





        function pulalinha() {
            return "\n";

        }


        let divBase;


        fetch("base.json").then((response) => {
            response.json().then((base) => {
                console.log(base);
                divBase = base;
            })
        }
        )


        function verificar() {
            var input = document.querySelector(".idInput");



            console.log(input.value);
            var achou = false;
            var indice;


            for (var i = 0; i < divBase.length; i++) {
                if (input.value == divBase[i].usuario) {
                    achou = true;
                    indice = i;
                    break;
                }
            }

            if (achou == true) {

                var nome = (divBase[indice].nome)
                var usuario = (divBase[i].usuario)
                var email = (divBase[i].email)
                var telefone = (divBase[i].telefone)
                var luck = (divBase[i].lucknumbers[0])
                var luck1 = (divBase[i].lucknumbers[1])
                var luck2 = (divBase[i].lucknumbers[2])
                console.log(nome);
                console.log(usuario);
                console.log(email);

                alert("Nome: " + nome + pulalinha() +
                    "Usuario: " + usuario + pulalinha() +
                    "Email: " + email + pulalinha() +
                    "Telefone: " + telefone + pulalinha() +
                    "Numeros da sorte: " + luck + ", " + luck1 + ", " + luck2);

            } else {
                alert("não foi encontrado este nome");
            }
        }





        var header = document.querySelector("header");
        var section = document.querySelector("section");



    </script>